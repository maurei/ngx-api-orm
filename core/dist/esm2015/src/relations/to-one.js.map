{"version":3,"file":"to-one.js","sourceRoot":"","sources":["../../package/src/relations/to-one.ts"],"names":[],"mappings":";;;;;AAEA,OAAO,EAAE,QAAQ,EAAqB,MAAM,UAAU,CAAC;;;;;;AAIvD,MAAM;;;;;;;IAGL,YACkB,eACA,gBACA,UACA;QAHA,kBAAa,GAAb,aAAa;QACb,mBAAc,GAAd,cAAc;QACd,aAAQ,GAAR,QAAQ;QACR,aAAQ,GAAR,QAAQ;;QAEzB,MAAM,SAAS,GAAO,aAAa,CAAC,cAAc,CAAC,aAAa,CAAC,IAAI,IAAI,CAAC;QAE1E,IAAI,CAAC,QAAQ,GAAG,SAAS,KAAK,IAAI,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,cAAc,CAAC,eAAe,CAAC,OAAO,CAAC,SAAS,CAAC,CAAC;KAC9F;;;;;IAQY,IAAI;;YAChB,IAAI,IAAI,CAAC,QAAQ,KAAK,IAAI,EAAE;gBAC3B,MAAM,IAAI,CAAC,MAAM,EAAE,CAAC;aACpB;iBAAM;gBACN,MAAM,IAAI,CAAC,GAAG,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;aAC9B;;;;;;;;IASW,MAAM,CAAC,UAA6B,EAAE;;YAClD,IAAI,IAAI,CAAC,QAAQ,EAAE;;gBAClB,MAAM,QAAQ,GAAG,OAAO,CAAC,WAAW,CAAC,QAAQ,CAAC,IAAI,EAAE,IAAI,CAAC,cAAc,CAAC,YAAY,CAAC,CAAC;;gBACtF,MAAM,WAAW,GAAG,OAAO,CAAC,WAAW,CAAC,QAAQ,CAAC,IAAI,EAAE,IAAI,CAAC,cAAc,CAAC,eAAe,CAAC,CAAC;;gBAC5F,MAAM,IAAI,GAAG,IAAI,CAAC,QAAQ,CAAC,MAAM,CAAC,IAAI,CAAC,QAAQ,EAAE,IAAI,CAAC,aAAa,CAAC,CAAC;gBACrE,MAAM,IAAI,CAAC,QAAQ,CAAC,MAAM,CAAC,WAAW,EAAE,QAAQ,EAAE,IAAI,EAAE,IAAI,CAAC,aAAa,EAAE,OAAO,CAAC,CAAC;gBACrF,IAAI,CAAC,QAAQ,GAAG,IAAI,CAAC;aACrB;;;;;;;;;IAQW,GAAG,CAAC,cAAwB,EAAE,UAA6B,EAAE;;;YACzE,MAAM,QAAQ,GAAG,OAAO,CAAC,WAAW,CAAC,QAAQ,CAAC,IAAI,EAAE,IAAI,CAAC,cAAc,CAAC,YAAY,CAAC,CAAC;;YACtF,MAAM,WAAW,GAAG,OAAO,CAAC,WAAW,CAAC,QAAQ,CAAC,IAAI,EAAE,IAAI,CAAC,cAAc,CAAC,eAAe,CAAC,CAAC;;YAC5F,MAAM,IAAI,GAAG,IAAI,CAAC,QAAQ,CAAC,GAAG,CAAC,cAAc,EAAE,IAAI,CAAC,aAAa,CAAC,CAAC;YACnE,MAAM,IAAI,CAAC,QAAQ,CAAC,GAAG,CAAC,WAAW,EAAE,QAAQ,EAAE,IAAI,EAAE,IAAI,CAAC,aAAa,EAAE,OAAO,CAAC,CAAC;YAClF,IAAI,CAAC,QAAQ,GAAG,cAAc,CAAC;;;CAEhC","sourcesContent":["import { RelationConfiguration } from './relation-configuration';\nimport { Resource } from '../resource.core';\nimport { METAKEYS, HttpClientOptions } from '../utils';\nimport { ToOneBuilder } from '../request-handlers/default-builders';\nimport { ToOneAdapter } from '../request-handlers/default-adapters';\n\nexport class ToOneRelation<THost extends Resource, TRelated extends Resource> {\n\t/** The references to the related instance */\n\tpublic instance: TRelated | null;\n\tconstructor(\n\t\tprivate readonly _hostInstance: THost,\n\t\tprivate readonly _configuration: RelationConfiguration<THost, TRelated>,\n\t\tprivate readonly _adapter: ToOneAdapter,\n\t\tprivate readonly _builder: ToOneBuilder\n\t) {\n\t\tconst rawObject: {} = _hostInstance[_configuration.keyOnInstance] || null;\n\n\t\tthis.instance = rawObject === null ? null : _configuration.RelatedResource.factory(rawObject);\n\t}\n\n\t// TODO: IMPLEMENT FETCH (LAZY GETTING OF RELATIONS)\n\n\t/**\n\t * Synchronize the model without using explicitly using `set` or `add`. This way it is possible to update a relation using e.g. DOM interactions without making premature requests.\n\t * @returns Promise<void>\n\t */\n\tpublic async sync(): Promise<void> {\n\t\tif (this.instance === null) {\n\t\t\tawait this.remove();\n\t\t} else {\n\t\t\tawait this.set(this.instance);\n\t\t}\n\t}\n\n\t/**\n\t * Runs the delete pipeline of your model for a related resource using the To-One request adapter and builder.\n\t * @param  TRelated targetInstance\n\t * @param  HttpClientOptions={} options\n\t * @returns Promise\n\t */\n\tpublic async remove(options: HttpClientOptions = {}): Promise<void> {\n\t\tif (this.instance) {\n\t\t\tconst hostName = Reflect.getMetadata(METAKEYS.NAME, this._configuration.HostResource);\n\t\t\tconst relatedName = Reflect.getMetadata(METAKEYS.NAME, this._configuration.RelatedResource);\n\t\t\tconst body = this._adapter.remove(this.instance, this._hostInstance);\n\t\t\tawait this._builder.remove(relatedName, hostName, body, this._hostInstance, options);\n\t\t\tthis.instance = null;\n\t\t}\n\t}\n\t/**\n\t * Runs the add pipeline of your model for a related resource using the To-One request adapter and builder.\n\t * @param  TRelated targetInstance\n\t * @param  HttpClientOptions={} options\n\t * @returns Promise\n\t */\n\tpublic async set(targetInstance: TRelated, options: HttpClientOptions = {}): Promise<void> {\n\t\tconst hostName = Reflect.getMetadata(METAKEYS.NAME, this._configuration.HostResource);\n\t\tconst relatedName = Reflect.getMetadata(METAKEYS.NAME, this._configuration.RelatedResource);\n\t\tconst body = this._adapter.add(targetInstance, this._hostInstance);\n\t\tawait this._builder.add(relatedName, hostName, body, this._hostInstance, options);\n\t\tthis.instance = targetInstance;\n\t}\n}\n"]}